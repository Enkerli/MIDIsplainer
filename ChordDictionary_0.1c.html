<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Chord Dictionary</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .container {
            background-color: #f5f5f5;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .input-group {
            margin-bottom: 1rem;
        }
        input {
            padding: 0.5rem;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-right: 0.5rem;
        }
        button {
            padding: 0.5rem 1rem;
            font-size: 1rem;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        #result {
            margin-top: 1rem;
            font-size: 1.1rem;
        }
        .chord-dictionary, .chord-management-section, .export-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #ccc;
        }
        .tabs {
            margin-bottom: 1rem;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            margin-right: 0.5rem;
            border: 1px solid #ccc;
            background: #f5f5f5;
            cursor: pointer;
            border-radius: 4px;
        }
        .tab-button.active {
            background: #007bff;
            color: white;
            border-color: #0056b3;
        }
        .tab-content {
            padding: 1rem;
            background: #f9f9f9;
            border-radius: 4px;
        }
        select {
            width: calc(100% - 1rem);
            margin-bottom: 0.5rem;
        }
        .input-group input, .input-group select {
            margin-bottom: 0.5rem;
            width: calc(100% - 1rem);
        }
        .binary-format {
            font-family: monospace;
            background: #f0f0f0;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }
        select {
            padding: 0.5rem;
            font-size: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        #chordList {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }
        .chord-item {
            background-color: white;
            padding: 1rem;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .chord-name {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .chord-intervals {
            color: #666;
            font-size: 0.9rem;
        }
        .chord-fullname {
			color: #444;
			font-style: italic;
			margin-bottom: 0.5rem;
		}
		.chord-forte {
			font-family: monospace;
			color: #666;
			background: #f0f0f0;
			padding: 0.2rem 0.4rem;
			border-radius: 3px;
			margin-bottom: 0.5rem;
		}
		.chord-scales, .chord-avoid {
			color: #666;
			font-size: 0.9rem;
			margin-bottom: 0.5rem;
		}

		.chord-scales {
			font-style: italic;
		}

		.chord-avoid {
			color: #d32f2f;
		}
		.result-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1rem;
		}

		.edit-button, .save-button {
			padding: 0.5rem 1rem;
			font-size: 0.9rem;
			border-radius: 4px;
			cursor: pointer;
		}

		.edit-button {
			background-color: #007bff;
			color: white;
			border: none;
		}

		.save-button {
			background-color: #28a745;
			color: white;
			border: none;
		}

		.result-edit .input-group {
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
		}

		.result-edit .input-group input {
			width: 100%;
			padding: 0.5rem;
			font-size: 1rem;
			border: 1px solid #ccc;
			border-radius: 4px;
		}
    </style>
</head>
<body>
    <div class="container">
        <h1>Enhanced Chord Dictionary</h1>
        <div class="input-group">
            <input type="text" id="chordInput" placeholder="Enter chord (e.g., Cmaj7)">
            <button id="findButton" onclick="findChordDetails()">Find</button>
        </div>
        <div id="result"></div>
    </div>

    <script>
        const chordData = {}; // Placeholder for JSON data

        async function loadChordData() {
            try {
                const response = await fetch('chord_dictionary.json');
                Object.assign(chordData, await response.json());
            } catch (error) {
                console.error('Failed to load chord data:', error);
            }
        }

        const noteToPC = {
            'C': 0, 'B#': 0, 'C#': 1, 'Db': 1,
            'D': 2, 'D#': 3, 'Eb': 3,
            'E': 4, 'Fb': 4, 'E#': 5,
            'F': 5, 'F#': 6, 'Gb': 6,
            'G': 7, 'G#': 8, 'Ab': 8,
            'A': 9, 'A#': 10, 'Bb': 10,
            'B': 11, 'Cb': 11
        };

        const letterNames = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];

        function getNotes(root, intervals) {
            const rootPC = noteToPC[root];
            return intervals.map(interval => {
                const noteIndex = (rootPC + interval) % 12;
                return Object.keys(noteToPC).find(key => noteToPC[key] === noteIndex);
            });
        }

        function orderPitchClasses(pcs, root = 0) {
            return pcs.map(pc => (pc - root + 12) % 12).sort((a, b) => a - b);
        }

        function findChordDetails() {
            const input = document.getElementById('chordInput').value.trim();
            if (!input) {
                alert('Please enter a chord.');
                return;
            }

            const match = input.match(/^([A-G][b#]?)(.*)$/);
            if (!match) {
                alert('Invalid chord format.');
                return;
            }

            const [_, root, quality] = match;
            const chord = chordData[quality];

            if (!chord) {
                alert('Chord quality not found.');
                return;
            }

            const orderedPCS = orderPitchClasses(chord.pcs, noteToPC[root]);
            const notes = getNotes(root, orderedPCS);

            document.getElementById('result').innerHTML = `
                <h2>${root}${quality}</h2>
                <p>Pitch Classes: ${orderedPCS.join(', ')}</p>
                <p>Notes: ${notes.join(', ')}</p>
                <p>Intervals: ${chord.intervals}</p>
            `;
        }

        window.onload = loadChordData;
    </script>
</body>
</html>
